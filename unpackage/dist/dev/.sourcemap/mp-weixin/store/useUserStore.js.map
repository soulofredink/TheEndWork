{"version":3,"file":"useUserStore.js","sources":["store/useUserStore.ts"],"sourcesContent":["import { defineStore } from 'pinia'\nimport { User } from '../static/interface/User'\r\n\nexport const useUserStore=defineStore('user',{\n\tstate:()=>({\n\t\tcurrentUser:null as User | null,//创建一个对象实例\n\t\tdefaultImg:'/static/OIP-C.jpg',\n\t\t//用户状态元数据\n\t\tmeta:{\n\t\t\tisLoggedin:false,\n\t\t\ttokenExpiresAt:0//token过期时间戳\n\t\t}\n\t}),\n\t\n\tgetters:{\n\t\tisLogin(state){\r\n\t\t\treturn state.meta.isLoggedin;\r\n\t\t}\n\t},\n\t\n\tactions:{\r\n\t\tasync Login(card:{username:string,password:string}){\r\n\t\t\tconst res =  await uni.request({\r\n\t\t\t    url:\"https://localhost:8443/signin\",\r\n\t\t\t\tmethod:'POST',\r\n\t\t\t\theader:{\r\n\t\t\t\t\t'Content-Type': 'application/json'\r\n\t\t\t\t},\r\n\t\t\t\tdata:JSON.stringify(card),\r\n\t\t\t\tsslVerify: false,\r\n\t\t\t})\r\n\t\t\tconsole.log(res);\r\n\t\t\tconst resVal = res.data as {code:number,message:string,data:any};\r\n\t\t\tif(resVal.code == 200){\r\n\t\t\t\tconsole.log('0k')\r\n\t\t\t\tthis.meta.isLoggedin = true\r\n\t\t\t\tthis.currentUser = resVal.data\r\n\t\t\t\treturn true\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t},\r\n})"],"names":["defineStore","uni"],"mappings":";;AAGa,MAAA,eAAaA,0BAAY,QAAO;AAAA,EAC5C,OAAM,OAAK;AAAA,IACV,aAAY;AAAA;AAAA,IACZ,YAAW;AAAA;AAAA,IAEX,MAAK;AAAA,MACJ,YAAW;AAAA,MACX,gBAAe;AAAA;AAAA,IAChB;AAAA,EAAA;AAAA,EAGD,SAAQ;AAAA,IACP,QAAQ,OAAM;AACb,aAAO,MAAM,KAAK;AAAA,IACnB;AAAA,EACD;AAAA,EAEA,SAAQ;AAAA,IACP,MAAM,MAAM,MAAuC;AAC5C,YAAA,MAAO,MAAMC,cAAA,MAAI,QAAQ;AAAA,QAC3B,KAAI;AAAA,QACP,QAAO;AAAA,QACP,QAAO;AAAA,UACN,gBAAgB;AAAA,QACjB;AAAA,QACA,MAAK,KAAK,UAAU,IAAI;AAAA,QACxB,WAAW;AAAA,MAAA,CACX;AACWA,oBAAAA,MAAA,MAAA,OAAA,+BAAA,GAAG;AACf,YAAM,SAAS,IAAI;AAChB,UAAA,OAAO,QAAQ,KAAI;AACrBA,sBAAAA,MAAA,MAAA,OAAA,+BAAY,IAAI;AAChB,aAAK,KAAK,aAAa;AACvB,aAAK,cAAc,OAAO;AACnB,eAAA;AAAA,MACR;AACO,aAAA;AAAA,IACR;AAAA,EAED;AACD,CAAC;;"}