{"version":3,"file":"communication.js","sources":["pages/communication/communication.vue","D:/HBuiderX/HBuilderX.4.64.2025042916/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY29tbXVuaWNhdGlvbi9jb21tdW5pY2F0aW9uLnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"main-container\">\r\n\t\t<scroll-view\r\n\t\t  class=\"chat-list\"\r\n\t\t  scroll-y\r\n\t\t  refresher-enabled\r\n\t\t  :refresher-triggered=\"isRefreshing\"\r\n\t\t>\r\n\t\t  <view \r\n\t\t    v-for=\"(chat, index) in chatList\"\r\n\t\t    :key=\"chat.id\"\r\n\t\t    class=\"chat-item\"\r\n\t\t    @click=\"handleChatClick(chat)\"\r\n\t\t  >\r\n\t\t    <!-- 头像 -->\r\n\t\t    <view class=\"avatar-wrapper\">\r\n\t\t      <image \r\n\t\t        class=\"avatar\" \r\n\t\t        :src=\"chat.avatar\" \r\n\t\t        mode=\"aspectFill\"\r\n\t\t      />\r\n\t\t    </view>\r\n\t\t\r\n\t\t    <view class=\"content\">\r\n\t\t      <view class=\"header\">\r\n\t\t        <text class=\"name\">{{ chat.username }}</text>\r\n\t\t        <text class=\"time\">{{ formatTime(chat.time) }}</text>\r\n\t\t      </view>\r\n\t\t\r\n\t\t      <!-- 消息 -->\r\n\t\t      <view class=\"preview\">\r\n\t\t        <text class=\"message\">{{ chat.lastMessage }}</text>\r\n\t\t        <view class=\"status\">\r\n\t\t          <!-- 未读消息 -->\r\n\t\t          <text \r\n\t\t            v-if=\"chat.unread > 0\"\r\n\t\t            class=\"badge\"\r\n\t\t            :class=\"{ 'badge-red': !chat.isMuted }\"\r\n\t\t          >\r\n\t\t            {{ chat.unread > 99 ? '99+' : chat.unread }}\r\n\t\t          </text>\r\n\t\t        </view>\r\n\t\t      </view>\r\n\t\t    </view>\r\n\t\t  </view>\r\n\t\t</scroll-view>\r\n\t</view>\n</template>\n\n<script setup lang='ts'>\n\timport { ref, computed } from 'vue';\r\n\timport { onShow } from '@dcloudio/uni-app';\r\n\t\r\n\t// 模拟数据\r\n\tconst chatList = ref([\r\n\t  {\r\n\t    id: 1,\r\n\t    username: '张三',\r\n\t    avatar: 'https://picsum.photos/80/80?1',//图片路径\r\n\t    lastMessage: 'null',\r\n\t    time: Date.now() - 3600*1000,\r\n\t    unread: 3,\r\n\t    isMuted: true,\r\n\t    isGroup: true\r\n\t  },\r\n\t  {\r\n\t    id: 2,\r\n\t    username: '李四',\r\n\t    avatar: 'https://picsum.photos/80/80?2',\r\n\t    lastMessage: 'null',\r\n\t    time: Date.now() - 2*3600*1000,\r\n\t    unread: 0,\r\n\t  },\r\n\t]);\r\n\t\r\n\t// 刷新状态\r\n\tconst isRefreshing = ref(false);\r\n\tconst isLoading = ref(false);\r\n\t\r\n\t// 时间\r\n\tconst formatTime = (timestamp) => {\r\n\t  const date = new Date(timestamp);\r\n\t  const now = new Date();\r\n\t  \r\n\t  // 显示时间\r\n\t  if (date.toDateString() === now.toDateString()) {\r\n\t    return date.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' });\r\n\t  }\r\n\t  if (date.getDate() === now.getDate() - 1) {\r\n\t    return '昨天';\r\n\t  }\r\n\t  return `${date.getMonth() + 1}/${date.getDate()}`;\r\n\t};\r\n\t\r\n\t// // 下拉刷新\r\n\t// const onRefresh = async () => {\r\n\t//   isRefreshing.value = true;\r\n\t//   // 模拟网络请求\r\n\t//   setTimeout(() => {\r\n\t//     // 这里应该获取最新数据\r\n\t//     isRefreshing.value = false;\r\n\t//     uni.showToast({ title: '刷新成功', icon: 'none' });\r\n\t//   }, 1000);\r\n\t// };\r\n\t\r\n\t// 点击聊天项\r\n\tconst handleChatClick = (chat) => {\r\n\t  uni.navigateTo({\r\n\t    url: '/pages/communicateDetails/communicateDetails?id=${chat.id}&username=${chat.username}'\r\n\t  });\r\n\t};\r\n\t\n</script>\n\n<style lang=\"scss\" scoped>\n\t.main-container {\r\n\t  padding: 24rpx;\r\n\t  background-color: #f5f7fa;\r\n\t  min-height: 100vh;\r\n\t}\r\n\t.search-bar {\r\n\t  padding: 15rpx 30rpx;\r\n\t  background-color: #fff;\r\n\t}\r\n\t\r\n\t.chat-list {\r\n\t  height: calc(100vh - 120rpx);\r\n\t}\r\n\t\r\n\t.chat-item {\r\n\t  display: flex;\r\n\t  padding: 20rpx 30rpx;\r\n\t  border-bottom: 1rpx solid #f5f5f5;\r\n\t\r\n\t  .avatar-wrapper {\r\n\t    position: relative;\r\n\t    margin-right: 25rpx;\r\n\t\r\n\t    .avatar {\r\n\t      width: 90rpx;\r\n\t      height: 90rpx;\r\n\t      border-radius: 8rpx;\r\n\t    }\r\n\t  }\r\n\t\r\n\t  .content {\r\n\t    flex: 1;\r\n\t    min-width: 0;\r\n\t\r\n\t    .header {\r\n\t      display: flex;\r\n\t      justify-content: space-between;\r\n\t      margin-bottom: 10rpx;\r\n\t\r\n\t      .name {\r\n\t        font-size: 34rpx;\r\n\t        color: #333;\r\n\t        max-width: 400rpx;\r\n\t        overflow: hidden;\r\n\t        text-overflow: ellipsis;\r\n\t        white-space: nowrap;\r\n\t      }\r\n\t\r\n\t      .time {\r\n\t        font-size: 24rpx;\r\n\t        color: #999;\r\n\t      }\r\n\t    }\r\n\t\r\n\t    .preview {\r\n\t      display: flex;\r\n\t      justify-content: space-between;\r\n\t\r\n\t      .message {\r\n\t        flex: 1;\r\n\t        font-size: 28rpx;\r\n\t        color: #999;\r\n\t        overflow: hidden;\r\n\t        text-overflow: ellipsis;\r\n\t        white-space: nowrap;\r\n\t        margin-right: 20rpx;\r\n\t      }\r\n\t\r\n\t      .status {\r\n\t        display: flex;\r\n\t        align-items: center;\r\n\t\r\n\t        .mute-icon {\r\n\t          margin-right: 10rpx;\r\n\t        }\r\n\t\r\n\t        .badge {\r\n\t          min-width: 36rpx;\r\n\t          height: 36rpx;\r\n\t          padding: 0 8rpx;\r\n\t          line-height: 36rpx;\r\n\t          text-align: center;\r\n\t          font-size: 22rpx;\r\n\t          color: white;\r\n\t          border-radius: 18rpx;\r\n\t          background-color: #999;\r\n\t\r\n\t          &-red {\r\n\t            background-color: #ff3b30;\r\n\t          }\r\n\t        }\r\n\t      }\r\n\t    }\r\n\t  }\r\n\t}\r\n\t\n</style>\n","import MiniProgramPage from 'E:/uniappWorkSpace/SaltyFish/pages/communication/communication.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni"],"mappings":";;;;;AAsDC,UAAM,WAAWA,cAAAA,IAAI;AAAA,MACnB;AAAA,QACE,IAAI;AAAA,QACJ,UAAU;AAAA,QACV,QAAQ;AAAA;AAAA,QACR,aAAa;AAAA,QACb,MAAM,KAAK,IAAI,IAAI,OAAK;AAAA,QACxB,QAAQ;AAAA,QACR,SAAS;AAAA,QACT,SAAS;AAAA,MACX;AAAA,MACA;AAAA,QACE,IAAI;AAAA,QACJ,UAAU;AAAA,QACV,QAAQ;AAAA,QACR,aAAa;AAAA,QACb,MAAM,KAAK,IAAI,IAAI,IAAE,OAAK;AAAA,QAC1B,QAAQ;AAAA,MACV;AAAA,IAAA,CACD;AAGK,UAAA,eAAeA,kBAAI,KAAK;AACZA,kBAAAA,IAAI,KAAK;AAGrB,UAAA,aAAa,CAAC,cAAc;AAC1B,YAAA,OAAO,IAAI,KAAK,SAAS;AACzB,YAAA,0BAAU;AAGhB,UAAI,KAAK,aAAA,MAAmB,IAAI,gBAAgB;AACvC,eAAA,KAAK,mBAAmB,SAAS,EAAE,MAAM,WAAW,QAAQ,WAAW;AAAA,MAChF;AACA,UAAI,KAAK,QAAQ,MAAM,IAAI,QAAA,IAAY,GAAG;AACjC,eAAA;AAAA,MACT;AACO,aAAA,GAAG,KAAK,aAAa,CAAC,IAAI,KAAK,QAAS,CAAA;AAAA,IAAA;AAe3C,UAAA,kBAAkB,CAAC,SAAS;AAChCC,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK;AAAA,MAAA,CACN;AAAA,IAAA;;;;;;;;;;;;;;;;;;;;;;;;AC5GJ,GAAG,WAAW,eAAe;"}