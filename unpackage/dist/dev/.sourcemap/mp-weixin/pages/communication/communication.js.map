{"version":3,"file":"communication.js","sources":["pages/communication/communication.vue","D:/HBuiderX/HBuilderX.4.64.2025042916/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY29tbXVuaWNhdGlvbi9jb21tdW5pY2F0aW9uLnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"main-container\">\r\n\t\t<view class=\"add-btn\" @click=\"handleAddChat\">\r\n\t\t\t<text class=\"btn-text\">+</text>\r\n\t\t</view>\r\n\t\t<scroll-view\r\n\t\t  class=\"chat-list\"\r\n\t\t  scroll-y\r\n\t\t  refresher-enabled\r\n\t\t>\r\n\t\t  <view \r\n\t\t    v-for=\"(chat, index) in chatList\"\r\n\t\t    :key=\"chat.id\"\r\n\t\t    class=\"chat-item\"\r\n\t\t    @click=\"handleChatClick(chat)\"\r\n\t\t  >\r\n\t\t    <!-- 头像 -->\r\n\t\t    <view class=\"avatar-wrapper\">\r\n\t\t      <image \r\n\t\t        class=\"avatar\" \r\n\t\t        :src=\"chat.avatar\" \r\n\t\t        mode=\"aspectFill\"\r\n\t\t      />\r\n\t\t    </view>\r\n\t\t\r\n\t\t    <view class=\"content\">\r\n\t\t      <view class=\"header\">\r\n\t\t        <text class=\"name\">{{ chat.username }}</text>\r\n\t\t        <text class=\"time\">{{ formatTime(chat.time) }}</text>\r\n\t\t      </view>\r\n\t\t\r\n\t\t      <!-- 消息 -->\r\n\t\t      <view class=\"preview\">\r\n\t\t        <text class=\"message\">{{ chat.lastMessage }}</text>\r\n\t\t        <view class=\"status\">\r\n\t\t          <!-- 未读消息 -->\r\n\t\t          <text \r\n\t\t            v-if=\"chat.unread > 0\"\r\n\t\t            class=\"badge\"\r\n\t\t          >\r\n\t\t            {{ chat.unread > 99 ? '99+' : chat.unread }}\r\n\t\t          </text>\r\n\t\t        </view>\r\n\t\t      </view>\r\n\t\t    </view>\r\n\t\t  </view>\r\n\t\t</scroll-view>\r\n\t</view>\n</template>\n\n<script setup lang='ts'>\n\timport { ref, computed ,getCurrentInstance,onMounted, onUnmounted} from 'vue';\r\n\timport { onShow } from '@dcloudio/uni-app';\r\n\timport { ChatMessage,ChatSession } from '../../static/interface/chat';\r\n\timport { useChatStore } from '../../store/chatStore';\r\n\timport { useUserStore } from '../../store/useUserStore';\r\n\timport websocketUtil from '../../script/webSocket';\r\n\timport {onLoad} from '@dcloudio/uni-app'\r\n\timport { ServerURL,WebsocketURL } from '../../config';\r\n\timport { User } from '../../static/interface/User';\r\n\tlet websocket: websocketUtil | null = null\r\n\tconst chatStore=useChatStore()\r\n\tconst userStore=useUserStore()\r\n\tconst userInfoCache = ref<Record<string, { username: string; avatar?: string }>>({})\r\n\t\r\n\tconst chatList = computed(() => {\n\t\treturn chatStore.sessions.map(session => {\n\t\t// 优先使用会话中的字段\n\t\tconst sessionUsername = session.username || userInfoCache.value[session.id]?.username;\n\t\tconst sessionAvatar = session.img || userInfoCache.value[session.id]?.avatar;\n\n\t\treturn {\n\t\t\tid: session.id,\n\t\t\tusername: sessionUsername || '加载中...',\n\t\t\tavatar: sessionAvatar || userStore.defaultImg,\n\t\t\tlastMessage: session.lastMessage?.content || '无消息',\n\t\t\ttime: session.lastMessage?.timestamp || '',\n\t\t\tunread: session.unreadCount\n\t\t}\n\t})\n\t})\r\n\t\r\n\t//websocket\r\n\tconst initWebSocket = () => {\r\n\t  if (!userStore.currentUser?.id) return\r\n\t  \r\n\t  websocket = new websocketUtil(\r\n\t    WebsocketURL+`${userStore.currentUser.id}`,\r\n\t    5000\r\n\t  )\r\n\t\r\n\t  websocket.getMessage((res:any)=>{\r\n\t  \tuni.__f__('log','at pages/communication/communication.vue:93',\"有人来消息了：\",res.sender)\r\n\t  \tif (chatStore.sessions.find(s => s.id === res.sender)) {\r\n\t  \t\tuni.__f__('log','at pages/communication/communication.vue:95',\"此消息的会话存在，不需要创建新的\")\r\n\t  \t}\r\n\t  \telse chatStore.createSession(res.sender)\r\n\t  \tconst a=Date.now()\r\n\t  \tconst s=a.toString()\r\n\t  \tchatStore.handleIncomingMessage({\r\n\t  \t\tid: s,\r\n\t  \t\tcontent: res.content,\r\n\t  \t\tsender: res.sender,\r\n\t  \t\treceiver: userStore.currentUser.id,\r\n\t  \t\ttimestamp:a\r\n\t  \t})\r\n\t    \tuni.__f__('log','at pages/communication/communication.vue:107',res);\r\n\t    })\r\n\t}\r\n\t\r\n\tconst addfriend = async (otherId: string) => {\r\n\t\t//uni.__f__('log','at pages/communication/communication.vue:112',userStore.currentUser.id)\r\n\t\tconst sid=userStore.currentUser.id\r\n\t  try {\r\n\t    const res :any= await uni.request({\r\n\t      url: ServerURL+\"/add/\"+sid+\"/\"+otherId,\r\n\t      method: 'GET',\r\n\t    })\r\n\t\tuni.__f__('log','at pages/communication/communication.vue:119',111111)\r\n\t    uni.__f__('log','at pages/communication/communication.vue:120',\"第一次连接后端状态码：\",res.statusCode)\r\n\t  } catch (error) {\r\n\t    uni.__f__('error','at pages/communication/communication.vue:122','连接失败:', error)\r\n\t\treturn 0;\r\n\t  }\r\n\t  \r\n\t}\r\n\t\r\n\t// 获取并缓存用户信息\r\n\tconst fetchUserInfo = async () => {\r\n\t  const sid=userStore.currentUser.id\r\n\t  try {\r\n\t    const res :any= await uni.request({\r\n\t      url: ServerURL+\"/get/\"+sid,\r\n\t      method: 'GET',\r\n\t    })\r\n\t    uni.__f__('log','at pages/communication/communication.vue:136',\"第二次连接后端状态码：\",res.statusCode)\r\n\t  \tuni.__f__('log','at pages/communication/communication.vue:137',res.data)\t\r\n\t    if (res.statusCode === 200) {\r\n\t\t\t const serverSessions: ChatSession[] = res.data.data.map((s: any) => ({\r\n\t\t\t\tid: s.id.toString(),\r\n\t\t\t\tunreadCount: 0, // 服务端不传未读数\r\n\t\t\t\timg:s.img,\r\n\t\t\t\tusername:s.username\r\n\t\t\t  }))\r\n\t\t\tuni.__f__('log','at pages/communication/communication.vue:145',serverSessions)\r\n\t\t\tchatStore.updateSessions(serverSessions)\r\n\t\t\tres.data.data.forEach(user => {\r\n\t\t\t\tuserInfoCache.value[user.id] = {\r\n\t\t\t\tusername: user.username || `用户${user.id}`,\r\n\t\t\t\tavatar: user.img || userStore.defaultImg\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t    }\r\n\t  } catch (error) {\r\n\t    uni.__f__('error','at pages/communication/communication.vue:155','用户信息获取失败:', error)\r\n\t  \t\treturn 0;\r\n\t  }\r\n\t}\r\n\t\r\n\t// 加载所有会话的用户信息\r\n\tconst loadSessionUsers = async () => {\r\n\t\tif(!userStore.meta.isLoggedin)return\r\n\t\tuni.__f__('log','at pages/communication/communication.vue:163',\"123\",chatStore.sessions)\r\n\t\tconst pendingRequests = chatStore.sessions\r\n\t    .filter(s => !userInfoCache.value[s.id])\r\n\t    .map(s => s.id)\r\n\t\t\r\n\t  await Promise.all(pendingRequests)\r\n\t}\r\n\t\r\n\t// 生命周期\r\n\tonMounted(async () => {\r\n\t  //initWebSocket()\r\n\t  //await fetchContacts()  // 先获取最新联系人\r\n\t  await loadSessionUsers()\r\n\t})\r\n\t\r\n\tonUnmounted(() => {\r\n\t  //websocket?.close()\r\n\t  uni.__f__('log','at pages/communication/communication.vue:180',\"关闭成功\")\r\n\t})\r\n\t\r\n\tonLoad(()=>{\r\n\t\tconst t=uni.getStorageSync(\"token\")\r\n\t\tif(t==true){\r\n\t\t\tuserStore.meta.isLoggedin=true\r\n\t\t\tuserStore.currentUser=uni.getStorageSync('userInfo') as User\r\n\t\t}\r\n\t\tuni.__f__('log','at pages/communication/communication.vue:189',\"1234568:\",userStore.meta.isLoggedin)\r\n\t\tuni.__f__('log','at pages/communication/communication.vue:190',userStore.currentUser.id)\r\n\t})\r\n\r\n\t// 刷新状态\r\n\tconst isRefreshing = ref(false);\r\n\tconst isLoading = ref(false);\r\n\t\r\n\t// 时间\r\n\tconst formatTime = (timestamp) => {\r\n\t  const date = new Date(timestamp);\r\n\t  const now = new Date();\r\n\t  \r\n\t  // 显示时间\r\n\t  if (date.toDateString() === now.toDateString()) {\r\n\t    return date.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' });\r\n\t  }\r\n\t  if (date.getDate() === now.getDate() - 1) {\r\n\t    return '昨天';\r\n\t  }\r\n\t  return `${date.getMonth() + 1}/${date.getDate()}`;\r\n\t};\r\n\t\r\n\t\r\n\t// 点击聊天项\r\n\tconst handleChatClick = (chat:typeof chatList.value[number]) => {\r\n\t\tconst targetSession = chatStore.sessions.find(s => s.id === chat.id)\r\n\t\t\r\n\t\tif (targetSession) {\r\n\t\t\ttargetSession.unreadCount = 0\r\n\t\t\tchatStore.persistSessions()\r\n\t\t}\r\n\t\tchatStore.updatereceiverId(chat.id)\r\n\t\tuni.__f__('log','at pages/communication/communication.vue:222',\"会话id：\",chat.id)\r\n\t\tuni.navigateTo({\r\n\t\t\t url:`/pages/communicateDetails/communicateDetails?id=${chat.id}&username=${chat.username}&avatar=${encodeURIComponent(chat.avatar)}`\r\n\t\t});\r\n\t};\r\n\t\r\n\tconst handleAddChat = async () => {\r\n\t    uni.showModal({\r\n\t      title: \"添加会话\",\r\n\t      content: \"\",\r\n\t      editable: true,\r\n\t      placeholderText: \"请输入用户ID\",\r\n\t      success: async (res) => {\r\n\t        if (res.confirm) {\r\n\t          const id = res.content.trim();\r\n\t\t\t  uni.__f__('log','at pages/communication/communication.vue:237',\"id:\",id)\r\n\t          if (!id) {\r\n\t            uni.showToast({ title: \"ID不能为空\", icon: \"none\" });\r\n\t            return;\r\n\t          }\r\n\t          // 检查是否已存在\r\n\t          if (chatStore.sessions.some(s => s.id === id)) {\r\n\t            uni.showToast({ title: \"会话已存在\", icon: \"none\" });\r\n\t            return;\r\n\t          }\r\n\t          try {\r\n\t            //if(!await addfriend(id))return;\r\n\t\t\t\tawait addfriend(id)\r\n\t\t\t\tuni.__f__('log','at pages/communication/communication.vue:250',50651051);\r\n\t\t\t\tchatStore.createSession(id)\r\n\t\t\t\tchatStore.persistSessions();\r\n\t\t\t\tawait fetchUserInfo()\t\r\n\t            uni.showToast({ title: \"添加成功\" });\r\n\t          } catch (error) {\r\n\t            uni.showToast({ title: \"用户不存在\", icon: \"none\" });\r\n\t          }\r\n\t        }\r\n\t      }\r\n\t    });\r\n\t  };\n</script>\n\n<style lang=\"scss\" scoped>\n\t.main-container {\r\n\t  padding: 24rpx;\r\n\t  background-color: #f5f7fa;\r\n\t  min-height: 100vh;\r\n\t}\r\n\t.add-btn {\r\n\t  position: fixed;\r\n\t  right: 30rpx;\r\n\t  bottom: 120rpx;  // 调整到 tabbar 上方（根据实际 tabbar 高度调整）\r\n\t  z-index: 1000;\r\n\t  width: 90rpx;   // 改为圆形需要宽高一致\r\n\t  height: 90rpx;  // 改为圆形需要宽高一致\r\n\t  border-radius: 50%;  // 关键改动：变为圆形\r\n\t  background-color: #ffe900;\r\n\t  display: flex;\r\n\t  align-items: center;\r\n\t  justify-content: center;\r\n\t  box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.1);\r\n\t  transition: transform 0.2s; // 添加点击动效\r\n\t\r\n\t  &:active {\r\n\t    transform: scale(0.9); // 点击缩小效果\r\n\t  }\r\n\t\r\n\t  .btn-text {\r\n\t    color: black;\r\n\t    font-weight: 250;\r\n\t    font-size: 70rpx;  // 稍微减小字号\r\n\t    line-height: 1;     // 修正行高\r\n\t    margin-top: -8rpx;  // 微调垂直居中\r\n\t  }\r\n\t}\r\n\t.search-bar {\r\n\t  padding: 15rpx 30rpx;\r\n\t  background-color: #fff;\r\n\t}\r\n\t\r\n\t.chat-list {\r\n\t  height: calc(100vh - 120rpx);\r\n\t}\r\n\t\r\n\t.chat-item {\r\n\t  display: flex;\r\n\t  padding: 20rpx 30rpx;\r\n\t  border-bottom: 1rpx solid #f5f5f5;\r\n\t\r\n\t  .avatar-wrapper {\r\n\t    position: relative;\r\n\t    margin-right: 25rpx;\r\n\t\r\n\t    .avatar {\r\n\t      width: 90rpx;\r\n\t      height: 90rpx;\r\n\t      border-radius: 8rpx;\r\n\t    }\r\n\t  }\r\n\t\r\n\t  .content {\r\n\t    flex: 1;\r\n\t    min-width: 0;\r\n\t\r\n\t    .header {\r\n\t      display: flex;\r\n\t      justify-content: space-between;\r\n\t      margin-bottom: 10rpx;\r\n\t\r\n\t      .name {\r\n\t        font-size: 34rpx;\r\n\t        color: #333;\r\n\t        max-width: 400rpx;\r\n\t        overflow: hidden;\r\n\t        text-overflow: ellipsis;\r\n\t        white-space: nowrap;\r\n\t      }\r\n\t\r\n\t      .time {\r\n\t        font-size: 24rpx;\r\n\t        color: #999;\r\n\t      }\r\n\t    }\r\n\t\r\n\t    .preview {\r\n\t      display: flex;\r\n\t      justify-content: space-between;\r\n\t\r\n\t      .message {\r\n\t        flex: 1;\r\n\t        font-size: 28rpx;\r\n\t        color: #999;\r\n\t        overflow: hidden;\r\n\t        text-overflow: ellipsis;\r\n\t        white-space: nowrap;\r\n\t        margin-right: 20rpx;\r\n\t      }\r\n\t\r\n\t      .status {\r\n\t        display: flex;\r\n\t        align-items: center;\r\n\t\r\n\t        .mute-icon {\r\n\t          margin-right: 10rpx;\r\n\t        }\r\n\t\r\n\t        .badge {\r\n\t          min-width: 36rpx;\r\n\t          height: 36rpx;\r\n\t          padding: 0 8rpx;\r\n\t          line-height: 36rpx;\r\n\t          text-align: center;\r\n\t          font-size: 22rpx;\r\n\t          color: white;\r\n\t          border-radius: 18rpx;\r\n\t          background-color: #999;\r\n\t\r\n\t          &-red {\r\n\t            background-color: #ff3b30;\r\n\t          }\r\n\t        }\r\n\t      }\r\n\t    }\r\n\t  }\r\n\t}\r\n\t\n</style>\n","import MiniProgramPage from 'E:/uniappWorkSpace/SaltyFish/pages/communication/communication.vue'\nwx.createPage(MiniProgramPage)"],"names":["useChatStore","useUserStore","ref","computed","uni","ServerURL","onMounted","onUnmounted","onLoad"],"mappings":"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"}