{"version":3,"file":"MyInfo.js","sources":["pages/MyInfo/MyInfo.vue","D:/HBuiderX/HBuilderX.4.64.2025042916/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvTXlJbmZvL015SW5mby52dWU"],"sourcesContent":["<template>\n  <view class=\"main-container\">\n    <!-- 个人信息卡片 -->\n    <view \n      class=\"mymessage-card\" \n      @click=\"toProfile('/pages/ProfileSet/ProfileSet')\"\n    >\n\t\t  <image class=\"headimg\"mode=\"aspectFill\"/>\n      <view class=\"info-wrapper\">\n        <text class=\"nickname\">{{username}}</text>\n        <text class=\"uid\">ID:{{id}}</text>\n      </view>\n      <uni-icons \n        type=\"forward\" \n        size=\"20\" \n        color=\"#999\" \n        class=\"arrow-icon\"\n      />\n    </view>\n\t<view class=\"mymarket\">\r\n\t  <!-- <view class=\"mymarket-title\">我的交易</view> -->\r\n\t  <view class=\"horizontal-list\">\r\n\t    <view class=\"flex-container\">\r\n\t      <view \r\n\t        v-for=\"(item,index) in services\" \r\n\t        :key=\"index\"\r\n\t        class=\"horizontal-item\"\r\n\t        @click=\"handleSetting(item)\"\r\n\t      >\r\n\t        <view class=\"item-content\">\r\n\t          <uni-icons \r\n\t            :type=\"item.icon\" \r\n\t            size=\"36\" \r\n\t            :color=\"item.color\"\r\n\t            class=\"service-icon\"\r\n\t          />\r\n\t          <text class=\"item-label\">{{ item.label }}</text>\r\n\t        </view>\r\n\t      </view>\r\n\t    </view>\r\n\t  </view>\r\n\t</view>\n\n    <view class=\"section\">\n      <view class=\"section-title\">账户设置</view>\n      <view class=\"list\">\n        <view \n          v-for=\"(item) in settings\"\n          :key=\"item.id\"\n          class=\"list-item\"\n          @click=\"handleSetting(item)\"\n        >\n          <view class=\"item-left\">\n            <uni-icons \n              :type=\"item.icon\" \n              size=\"20\" \n              :color=\"item.color\"\n            />\n            <text class=\"item-label\">{{ item.label }}</text>\n          </view>\n          <uni-icons \n            type=\"forward\" \n            size=\"16\" \n            color=\"#ccc\"\n          />\n        </view>\n      </view>\n    </view>\r\n\t<view class=\"logout-btn-container\">\r\n\t  <button \r\n\t    class=\"logout-btn\"\r\n\t    @click=\"handleLogout\"\r\n\t  >\r\n\t    退出登录\r\n\t  </button>\r\n\t</view>\n  </view>\n</template>\r\n\n<script setup lang=\"ts\">\n\timport {ref,reactive, onMounted} from 'vue'\n\timport { useUserStore } from '../../store/useUserStore'\r\n\timport { storeToRefs } from 'pinia'\r\n\timport {onLoad} from '@dcloudio/uni-app'\r\n\timport { User } from '../../static/interface/User'\r\n\timport { useChatStore } from '../../store/chatStore'\n\tlet username = ref(\"请登录\");\r\n\tlet id = ref('');\r\n\tlet userStore = useUserStore()\r\n\tlet chatStore=useChatStore()\n\tconst services = reactive([\r\n\t  { id:1,icon: 'shop', color: '#00C853', label: '我发布的', path: '/pages' },\r\n\t  { id:2,icon: 'cart', color: '#0091EA', label: '我卖出的', path: '/pages' },\r\n\t  { id:3,icon: 'gift', color: '#FF6D00', label: '我买到的', path: '/pages/about_us/about_us' }\r\n\t])\n\tconst settings = reactive([\n\t  { id:1,icon: 'gear', color: '#666', label: '账户安全', path: '/pages/security' },\n\t  { id:2,icon: 'notification', color: '#666', label: '消息通知', path: '/pages/notify' },\n\t  { id:3,icon: 'clear', color: '#666', label: '清理缓存', path: 'clearCache' }\n\t])\n\t\n\t\n\tconst toProfile=(path:any)=>{\r\n\t\t//uni.__f__('log','at pages/MyInfo/MyInfo.vue:104',\"info::\",userStore.meta.isLoggedin)\r\n\t\t//uni.__f__('log','at pages/MyInfo/MyInfo.vue:105',userStore.currentUser.id)\r\n\t\tif(!userStore.meta.isLoggedin){\r\n\t\t\tuni.redirectTo({url:\"/pages/SignIn/SignIn\"})\r\n\t\t}else  {\r\n\t\t  uni.navigateTo({ url: path })\r\n\t\t}\r\n\t}\r\n\n\tconst handleSetting = (item: any) => {\n\t  if(item.path != 'clearCache'){\r\n\t\t  uni.navigateTo({\r\n\t\t\turl: item.path,\r\n\t\t  })\r\n\t  }else{\r\n\t\t  uni.showModal({\r\n\t\t\ttitle: '提示',\r\n\t\t\tcontent: '确定要清除缓存吗？',\r\n\t\t\tsuccess: (res) => {\r\n\t\t\t  if (res.confirm) {\r\n\t\t\t\t// 执行清除缓存逻辑\r\n\t\t\t\tuni.removeStorageSync(\"token\")\r\n\t\t\t\tuni.removeStorageSync(\"userInfo\")\r\n\t\t\t\tchatStore.clearLocalData()\r\n\t\t\t  }\r\n\t\t\t}\r\n\t\t  })\r\n\t  }\n\t}\r\n\tonLoad(()=>{\r\n\t\t\tconst t=uni.getStorageSync(\"token\")\r\n\t\t\tuni.__f__('log','at pages/MyInfo/MyInfo.vue:135',t)\r\n\t\t\tif(t==true){\r\n\t\t\t\tuni.__f__('log','at pages/MyInfo/MyInfo.vue:137',123)\r\n\t\t\t\tuserStore.meta.isLoggedin = true;\r\n\t\t\t\tlet userInfo = uni.getStorageSync('userInfo') as User\r\n\t\t\t\tuserStore.currentUser= uni.getStorageSync('userInfo') as User\r\n\t\t\t\tusername.value = userInfo.username;\r\n\t\t\t\tid.value = userInfo.id;\r\n\t\t\t}else{\r\n\t\t\t\tusername.value = userStore.currentUser.username\r\n\t\t\t\tid.value = userStore.currentUser.id;\r\n\t\t\t}\r\n\t})\r\n\t\r\n\tconst handleLogout = () => {\r\n\t  uni.showModal({\r\n\t    title: '确认退出',\r\n\t    content: '确定要退出当前账号吗？',\r\n\t    success: (res) => {\r\n\t      if (res.confirm) {\r\n\t        uni.removeStorageSync(\"token\")\r\n\t        uni.removeStorageSync(\"userInfo\")\r\n\t        //chatStore.clearLocalData()\r\n\t        // 重置用户状态\r\n\t        userStore.$reset()\r\n\t        uni.reLaunch({\r\n\t          url: '/pages/SignIn/SignIn'\r\n\t        })\r\n\t      }\r\n\t    }\r\n\t  })\r\n\t}\n</script>\n\n<style lang=\"scss\" scoped>\n.main-container {\n  padding: 24rpx;\n  background-color: #f5f7fa;\n  min-height: 100vh;\n}\n\n.mymessage-card {\n  background: #fff;\n  border-radius: 16rpx;\n  padding: 32rpx;\n  margin-bottom: 24rpx;\n  display: flex;\n  align-items: center;\n  position: relative;\n  box-shadow: 0 4rpx 12rpx rgba(0,0,0,0.05);\n\n  .headimg {\n    width: 145rpx;\n    height: 145rpx;\n    border-radius: 35rpx;\n    margin-right: 32rpx;\n    border: 2rpx solid #f0f0f0;\n  }\n\n  .info-wrapper {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n\n    .nickname {\n      font-size: 36rpx;\n      font-weight: 500;\n      color: #333;\n      margin-bottom: 12rpx;\n    }\n\n    .uid {\n\t  margin-top: 10rpx;\n      font-size: 25rpx;\n      color: #999;\n    }\n  }\n\n  .arrow-icon {\n    margin-left: auto;\n  }\n}\n\n\n.section {\n  background: #fff;\n  border-radius: 16rpx;\n  padding: 0 24rpx;\n  margin-bottom: 50rpx;\r\n  margin-top: 30rpx;\n  .section-title {\n    font-size: 32rpx;\n    font-weight: 500;\n    color: #333;\n    padding: 24rpx 0;\n    border-bottom: 1rpx solid #eee;\n  }\n\n  .list {\n    .list-item {\n      padding: 32rpx 0;\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      border-bottom: 1rpx solid #eee;\n\n      &:last-child {\n        border-bottom: none;\n      }\n\n      .item-left {\n        display: flex;\n        align-items: center;\n\n        .item-label {\n          font-size: 30rpx;\n          color: #333;\n          margin-left: 24rpx;\n        }\n      }\n    }\n  }\n}\r\n.mymarket{\r\n\tbackground: #fff;\r\n\tborder-radius: 16rpx;\r\n\tpadding: 0 24rpx;\r\n\tmargin-bottom: 12rpx;\r\n}\n.horizontal-list {\n  //padding: 10rpx 0;\n  \n  .flex-container {\n    display: flex;\n    justify-content: space-between;\n    padding: 0 10rpx;\n  }\n\n  .horizontal-item {\n    flex: 1;\n    margin: 0 10rpx;\n    //background: #f8f9fa;\n    border-radius: 16rpx;\n    padding: 20rpx 0;\n    \n    .item-content {\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      \n      .service-icon {\n        margin-bottom: 20rpx;\n        background: #fff;\n        padding: 16rpx;\n        border-radius: 50%;\n        box-shadow: 0 4rpx 12rpx rgba(0,0,0,0.1);\n      }\n      \n      .item-label {\n        font-size: 26rpx;\n        color: #333;\n        text-align: center;\n        line-height: 1.4;\n        white-space: nowrap;\n      }\n    }\n  }\n}\r\n// 在 style 最后添加\n.logout-btn-container {\n  margin: 100rpx 20rpx 0;\n  padding-bottom: 0rpx;\n\n  .logout-btn {\n    background-color: #ffe900;\n    color: black;\n    border-radius: 50rpx;\n    font-size: 32rpx;\n    height: 88rpx;\n    line-height: 88rpx;\n    transition: opacity 0.2s;\n    \n    &::after {\n      border: none;\n    }\n    \n    &:active {\n      opacity: 0.8;\n    }\n  }\n}\n</style>","import MiniProgramPage from 'E:/uniappWorkSpace/SaltyFish/pages/MyInfo/MyInfo.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","useUserStore","useChatStore","reactive","uni","onLoad"],"mappings":";;;;;;;;;;;;;;;AAsFK,QAAA,WAAWA,kBAAI,KAAK;AACpB,QAAA,KAAKA,kBAAI,EAAE;AACf,QAAI,YAAYC,mBAAAA;AAChB,QAAI,YAAUC,gBAAAA;AACd,UAAM,WAAWC,cAAAA,SAAS;AAAA,MACxB,EAAE,IAAG,GAAE,MAAM,QAAQ,OAAO,WAAW,OAAO,QAAQ,MAAM,SAAS;AAAA,MACrE,EAAE,IAAG,GAAE,MAAM,QAAQ,OAAO,WAAW,OAAO,QAAQ,MAAM,SAAS;AAAA,MACrE,EAAE,IAAG,GAAE,MAAM,QAAQ,OAAO,WAAW,OAAO,QAAQ,MAAM,2BAA2B;AAAA,IAAA,CACxF;AACD,UAAM,WAAWA,cAAAA,SAAS;AAAA,MACxB,EAAE,IAAG,GAAE,MAAM,QAAQ,OAAO,QAAQ,OAAO,QAAQ,MAAM,kBAAkB;AAAA,MAC3E,EAAE,IAAG,GAAE,MAAM,gBAAgB,OAAO,QAAQ,OAAO,QAAQ,MAAM,gBAAgB;AAAA,MACjF,EAAE,IAAG,GAAE,MAAM,SAAS,OAAO,QAAQ,OAAO,QAAQ,MAAM,aAAa;AAAA,IAAA,CACxE;AAGK,UAAA,YAAU,CAAC,SAAW;AAGxB,UAAA,CAAC,UAAU,KAAK,YAAW;AAC7BC,sBAAAA,MAAI,WAAW,EAAC,KAAI,uBAAuB,CAAA;AAAA,MAAA,OACrC;AACLA,sBAAAA,MAAI,WAAW,EAAE,KAAK,KAAM,CAAA;AAAA,MAC9B;AAAA,IAAA;AAGK,UAAA,gBAAgB,CAAC,SAAc;AAChC,UAAA,KAAK,QAAQ,cAAa;AAC5BA,sBAAAA,MAAI,WAAW;AAAA,UAChB,KAAK,KAAK;AAAA,QAAA,CACR;AAAA,MAAA,OACG;AACJA,sBAAAA,MAAI,UAAU;AAAA,UACf,OAAO;AAAA,UACP,SAAS;AAAA,UACT,SAAS,CAAC,QAAQ;AAChB,gBAAI,IAAI,SAAS;AAElBA,kCAAI,kBAAkB,OAAO;AAC7BA,kCAAI,kBAAkB,UAAU;AAChC,wBAAU,eAAe;AAAA,YACxB;AAAA,UACF;AAAA,QAAA,CACE;AAAA,MACF;AAAA,IAAA;AAEFC,kBAAAA,OAAO,MAAI;AACH,YAAA,IAAED,cAAAA,MAAI,eAAe,OAAO;AAC9BA,oBAAAA,MAAA,MAAM,OAAM,kCAAiC,CAAC;AAClD,UAAG,KAAG,MAAK;AACNA,sBAAAA,MAAA,MAAM,OAAM,kCAAiC,GAAG;AACpD,kBAAU,KAAK,aAAa;AACxB,YAAA,WAAWA,cAAAA,MAAI,eAAe,UAAU;AAClC,kBAAA,cAAaA,cAAAA,MAAI,eAAe,UAAU;AACpD,iBAAS,QAAQ,SAAS;AAC1B,WAAG,QAAQ,SAAS;AAAA,MAAA,OAChB;AACK,iBAAA,QAAQ,UAAU,YAAY;AACpC,WAAA,QAAQ,UAAU,YAAY;AAAA,MAClC;AAAA,IAAA,CACD;AAED,UAAM,eAAe,MAAM;AACzBA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,CAAC,QAAQ;AAChB,cAAI,IAAI,SAAS;AACfA,gCAAI,kBAAkB,OAAO;AAC7BA,gCAAI,kBAAkB,UAAU;AAGhC,sBAAU,OAAO;AACjBA,0BAAAA,MAAI,SAAS;AAAA,cACX,KAAK;AAAA,YAAA,CACN;AAAA,UACH;AAAA,QACF;AAAA,MAAA,CACD;AAAA,IAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnKJ,GAAG,WAAW,eAAe;"}